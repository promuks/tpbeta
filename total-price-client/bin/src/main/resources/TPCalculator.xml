<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" 
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
       xmlns:context="http://www.springframework.org/schema/context"
	   xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd       
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd
       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd
       http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd
       http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee.xsd
       http://www.springframework.org/schema/data/mongo http://www.springframework.org/schema/data/mongo/spring-mongo-1.0.xsd" 
       xmlns:tx="http://www.springframework.org/schema/tx" 
       xmlns:aop="http://www.springframework.org/schema/aop" 
       xmlns:util="http://www.springframework.org/schema/util" 
       xmlns:jee="http://www.springframework.org/schema/jee"
       xmlns:mongo="http://www.springframework.org/schema/data/mongo">
    
   	<context:property-placeholder location="classpath:engine.properties"/>
	
	<mongo:mongo host="${mongodb.host}" port="${mongodb.port}" />
 
	<mongo:db-factory id="mainDBFactory"
	                  dbname="tpsCalculatorTest" mongo-ref="mongo" />

	<bean id="mongoTemplate" class="org.springframework.data.mongodb.core.MongoTemplate">
		<constructor-arg name="mongoDbFactory" ref="mainDBFactory" />
		<constructor-arg name="mongoConverter" ref="mappingMongoConverter" />
	</bean>
 	<bean id="mappingContext" class="org.springframework.data.mongodb.core.mapping.MongoMappingContext" />

 	<bean id="defaultMongoTypeMapper" class="org.springframework.data.mongodb.core.convert.DefaultMongoTypeMapper">
		<constructor-arg name="typeKey"><null/></constructor-arg>
 	</bean>

 	<bean id="mappingMongoConverter" class="org.springframework.data.mongodb.core.convert.MappingMongoConverter">
		<constructor-arg name="mongoDbFactory" ref="mainDBFactory" />
		<constructor-arg name="mappingContext" ref="mappingContext" />
		<property name="typeMapper" ref="defaultMongoTypeMapper" />
 	</bean>		
	<bean id="jndiProperties"
		class="org.springframework.beans.factory.config.PropertiesFactoryBean">
		<property name="properties">
			<props>
				<prop key="java.naming.factory.url.pkgs">org.jboss.ejb.client.naming</prop>
				<prop key="jboss.naming.client.ejb.context">true</prop>
			</props>
		</property>
	</bean>		
	
	<jee:remote-slsb id="calendarPricingModule"
		business-interface="com.farecompare.atppricing.calendarpricingmodule.api.CalendarPricingModuleAPI"
		environment-ref="jndiProperties"
		jndi-name="ejb:bttb-priority/farecompare-atppricing-pricing-current-pro-module-ejb/CalendarPricingProModuleSessionBean!com.farecompare.atppricing.calendarpricingmodule.api.CalendarPricingModuleAPI">
	</jee:remote-slsb>
</beans>